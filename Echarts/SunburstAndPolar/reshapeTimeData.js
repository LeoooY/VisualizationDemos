let data = { "aggs": [{ "value": [0], "key": 1547188423000 }, { "value": [0], "key": 1547190000000 }, { "value": [0], "key": 1547193600000 }, { "value": [0], "key": 1547197200000 }, { "value": [0], "key": 1547200800000 }, { "value": [0], "key": 1547204400000 }, { "value": [0], "key": 1547208000000 }, { "value": [0], "key": 1547211600000 }, { "value": [0], "key": 1547215200000 }, { "value": [0], "key": 1547218800000 }, { "value": [0], "key": 1547222400000 }, { "value": [0], "key": 1547226000000 }, { "value": [0], "key": 1547229600000 }, { "value": [0], "key": 1547233200000 }, { "value": [0], "key": 1547236800000 }, { "value": [0], "key": 1547240400000 }, { "value": [0], "key": 1547244000000 }, { "value": [0], "key": 1547247600000 }, { "value": [0], "key": 1547251200000 }, { "value": [0], "key": 1547254800000 }, { "value": [0], "key": 1547258400000 }, { "value": [0], "key": 1547262000000 }, { "value": [0], "key": 1547265600000 }, { "value": [0], "key": 1547269200000 }, { "value": [0], "key": 1547272800000 }, { "value": [0], "key": 1547276400000 }, { "value": [0], "key": 1547280000000 }, { "value": [0], "key": 1547283600000 }, { "value": [0], "key": 1547287200000 }, { "value": [0], "key": 1547290800000 }, { "value": [0], "key": 1547294400000 }, { "value": [0], "key": 1547298000000 }, { "value": [0], "key": 1547301600000 }, { "value": [0], "key": 1547305200000 }, { "value": [0], "key": 1547308800000 }, { "value": [0], "key": 1547312400000 }, { "value": [0], "key": 1547316000000 }, { "value": [0], "key": 1547319600000 }, { "value": [0], "key": 1547323200000 }, { "value": [0], "key": 1547326800000 }, { "value": [0], "key": 1547330400000 }, { "value": [0], "key": 1547334000000 }, { "value": [0], "key": 1547337600000 }, { "value": [0], "key": 1547341200000 }, { "value": [0], "key": 1547344800000 }, { "value": [0], "key": 1547348400000 }, { "value": [0], "key": 1547352000000 }, { "value": [0], "key": 1547355600000 }, { "value": [0], "key": 1547359200000 }, { "value": [0], "key": 1547362800000 }, { "value": [0], "key": 1547366400000 }, { "value": [0], "key": 1547370000000 }, { "value": [0], "key": 1547373600000 }, { "value": [0], "key": 1547377200000 }, { "value": [0], "key": 1547380800000 }, { "value": [0], "key": 1547384400000 }, { "value": [0], "key": 1547388000000 }, { "value": [1], "key": 1547391600000 }, { "value": [0], "key": 1547395200000 }, { "value": [0], "key": 1547398800000 }, { "value": [0], "key": 1547402400000 }, { "value": [0], "key": 1547406000000 }, { "value": [0], "key": 1547409600000 }, { "value": [0], "key": 1547413200000 }, { "value": [0], "key": 1547416800000 }, { "value": [0], "key": 1547420400000 }, { "value": [0], "key": 1547424000000 }, { "value": [0], "key": 1547427600000 }, { "value": [0], "key": 1547431200000 }, { "value": [0], "key": 1547434800000 }, { "value": [0], "key": 1547438400000 }, { "value": [0], "key": 1547442000000 }, { "value": [0], "key": 1547445600000 }, { "value": [0], "key": 1547449200000 }, { "value": [0], "key": 1547452800000 }, { "value": [0], "key": 1547456400000 }, { "value": [0], "key": 1547460000000 }, { "value": [0], "key": 1547463600000 }, { "value": [0], "key": 1547467200000 }, { "value": [0], "key": 1547470800000 }, { "value": [0], "key": 1547474400000 }, { "value": [0], "key": 1547478000000 }, { "value": [0], "key": 1547481600000 }, { "value": [0], "key": 1547485200000 }, { "value": [0], "key": 1547488800000 }, { "value": [0], "key": 1547492400000 }, { "value": [0], "key": 1547496000000 }, { "value": [0], "key": 1547499600000 }, { "value": [0], "key": 1547503200000 }, { "value": [0], "key": 1547506800000 }, { "value": [0], "key": 1547510400000 }, { "value": [0], "key": 1547514000000 }, { "value": [0], "key": 1547517600000 }, { "value": [0], "key": 1547521200000 }, { "value": [0], "key": 1547524800000 }, { "value": [0], "key": 1547528400000 }, { "value": [0], "key": 1547532000000 }, { "value": [0], "key": 1547535600000 }, { "value": [0], "key": 1547539200000 }, { "value": [0], "key": 1547542800000 }, { "value": [0], "key": 1547546400000 }, { "value": [0], "key": 1547550000000 }, { "value": [0], "key": 1547553600000 }, { "value": [0], "key": 1547557200000 }, { "value": [0], "key": 1547560800000 }, { "value": [0], "key": 1547564400000 }, { "value": [0], "key": 1547568000000 }, { "value": [0], "key": 1547571600000 }, { "value": [0], "key": 1547575200000 }, { "value": [0], "key": 1547578800000 }, { "value": [0], "key": 1547582400000 }, { "value": [0], "key": 1547586000000 }, { "value": [0], "key": 1547589600000 }, { "value": [0], "key": 1547593200000 }, { "value": [0], "key": 1547596800000 }, { "value": [0], "key": 1547600400000 }, { "value": [0], "key": 1547604000000 }, { "value": [0], "key": 1547607600000 }, { "value": [0], "key": 1547611200000 }, { "value": [0], "key": 1547614800000 }, { "value": [0], "key": 1547618400000 }, { "value": [0], "key": 1547622000000 }, { "value": [0], "key": 1547625600000 }, { "value": [0], "key": 1547629200000 }, { "value": [0], "key": 1547632800000 }, { "value": [0], "key": 1547636400000 }, { "value": [0], "key": 1547640000000 }, { "value": [0], "key": 1547643600000 }, { "value": [1], "key": 1547647200000 }, { "value": [2], "key": 1547650800000 }, { "value": [0], "key": 1547654400000 }, { "value": [0], "key": 1547658000000 }, { "value": [0], "key": 1547661600000 }, { "value": [0], "key": 1547665200000 }, { "value": [0], "key": 1547668800000 }, { "value": [0], "key": 1547672400000 }, { "value": [0], "key": 1547676000000 }, { "value": [0], "key": 1547679600000 }, { "value": [0], "key": 1547683200000 }, { "value": [0], "key": 1547686800000 }, { "value": [0], "key": 1547690400000 }, { "value": [0], "key": 1547694000000 }, { "value": [0], "key": 1547697600000 }, { "value": [0], "key": 1547701200000 }, { "value": [0], "key": 1547704800000 }, { "value": [1], "key": 1547708400000 }, { "value": [0], "key": 1547712000000 }, { "value": [1], "key": 1547715600000 }, { "value": [1], "key": 1547719200000 }, { "value": [0], "key": 1547722800000 }, { "value": [0], "key": 1547726400000 }, { "value": [0], "key": 1547730000000 }, { "value": [0], "key": 1547733600000 }, { "value": [0], "key": 1547737200000 }, { "value": [0], "key": 1547740800000 }, { "value": [0], "key": 1547744400000 }, { "value": [0], "key": 1547748000000 }, { "value": [0], "key": 1547751600000 }, { "value": [0], "key": 1547755200000 }, { "value": [0], "key": 1547758800000 }, { "value": [0], "key": 1547762400000 }, { "value": [0], "key": 1547766000000 }, { "value": [0], "key": 1547769600000 }, { "value": [0], "key": 1547773200000 }, { "value": [0], "key": 1547776800000 }, { "value": [0], "key": 1547780400000 }, { "value": [0], "key": 1547784000000 }, { "value": [0], "key": 1547787600000 }, { "value": [0], "key": 1547791200000 }, { "value": [0], "key": 1547794800000 }, { "value": [0], "key": 1547798400000 }, { "value": [2], "key": 1547802000000 }, { "value": [0], "key": 1547805600000 }, { "value": [0], "key": 1547809200000 }, { "value": [0], "key": 1547812800000 }, { "value": [0], "key": 1547816400000 }, { "value": [0], "key": 1547820000000 }, { "value": [0], "key": 1547823600000 }, { "value": [0], "key": 1547827200000 }, { "value": [0], "key": 1547830800000 }, { "value": [0], "key": 1547834400000 }, { "value": [0], "key": 1547838000000 }, { "value": [0], "key": 1547841600000 }, { "value": [0], "key": 1547845200000 }, { "value": [0], "key": 1547848800000 }, { "value": [0], "key": 1547852400000 }, { "value": [0], "key": 1547856000000 }, { "value": [0], "key": 1547859600000 }, { "value": [0], "key": 1547863200000 }, { "value": [0], "key": 1547866800000 }, { "value": [0], "key": 1547870400000 }, { "value": [2], "key": 1547874000000 }, { "value": [0], "key": 1547877600000 }, { "value": [0], "key": 1547881200000 }, { "value": [0], "key": 1547884800000 }, { "value": [0], "key": 1547888400000 }, { "value": [0], "key": 1547892000000 }, { "value": [0], "key": 1547895600000 }, { "value": [0], "key": 1547899200000 }, { "value": [0], "key": 1547902800000 }, { "value": [0], "key": 1547906400000 }, { "value": [0], "key": 1547910000000 }, { "value": [0], "key": 1547913600000 }, { "value": [0], "key": 1547917200000 }, { "value": [0], "key": 1547920800000 }, { "value": [0], "key": 1547924400000 }, { "value": [0], "key": 1547928000000 }, { "value": [0], "key": 1547931600000 }, { "value": [0], "key": 1547935200000 }, { "value": [0], "key": 1547938800000 }, { "value": [0], "key": 1547942400000 }, { "value": [0], "key": 1547946000000 }, { "value": [0], "key": 1547949600000 }, { "value": [0], "key": 1547953200000 }, { "value": [0], "key": 1547956800000 }, { "value": [0], "key": 1547960400000 }, { "value": [0], "key": 1547964000000 }, { "value": [0], "key": 1547967600000 }, { "value": [0], "key": 1547971200000 }, { "value": [0], "key": 1547974800000 }, { "value": [1], "key": 1547978400000 }, { "value": [0], "key": 1547982000000 }, { "value": [0], "key": 1547985600000 }, { "value": [0], "key": 1547989200000 }, { "value": [0], "key": 1547992800000 }, { "value": [0], "key": 1547996400000 }, { "value": [0], "key": 1548000000000 }, { "value": [0], "key": 1548003600000 }, { "value": [0], "key": 1548007200000 }, { "value": [0], "key": 1548010800000 }, { "value": [0], "key": 1548014400000 }, { "value": [0], "key": 1548018000000 }, { "value": [0], "key": 1548021600000 }, { "value": [0], "key": 1548025200000 }, { "value": [0], "key": 1548028800000 }, { "value": [0], "key": 1548032400000 }, { "value": [0], "key": 1548036000000 }, { "value": [0], "key": 1548039600000 }, { "value": [0], "key": 1548043200000 }, { "value": [1], "key": 1548046800000 }, { "value": [0], "key": 1548050400000 }, { "value": [0], "key": 1548054000000 }, { "value": [0], "key": 1548057600000 }, { "value": [0], "key": 1548061200000 }, { "value": [0], "key": 1548064800000 }, { "value": [0], "key": 1548068400000 }, { "value": [0], "key": 1548072000000 }, { "value": [0], "key": 1548075600000 }, { "value": [0], "key": 1548079200000 }, { "value": [0], "key": 1548082800000 }, { "value": [0], "key": 1548086400000 }, { "value": [0], "key": 1548090000000 }, { "value": [0], "key": 1548093600000 }, { "value": [0], "key": 1548097200000 }, { "value": [0], "key": 1548100800000 }, { "value": [0], "key": 1548104400000 }, { "value": [0], "key": 1548108000000 }, { "value": [0], "key": 1548111600000 }, { "value": [0], "key": 1548115200000 }, { "value": [0], "key": 1548118800000 }, { "value": [0], "key": 1548122400000 }, { "value": [0], "key": 1548126000000 }, { "value": [0], "key": 1548129600000 }, { "value": [2], "key": 1548133200000 }, { "value": [0], "key": 1548136800000 }, { "value": [0], "key": 1548140400000 }, { "value": [0], "key": 1548144000000 }, { "value": [0], "key": 1548147600000 }, { "value": [0], "key": 1548151200000 }, { "value": [0], "key": 1548154800000 }, { "value": [0], "key": 1548158400000 }, { "value": [0], "key": 1548162000000 }, { "value": [0], "key": 1548165600000 }, { "value": [0], "key": 1548169200000 }, { "value": [0], "key": 1548172800000 }, { "value": [0], "key": 1548176400000 }, { "value": [0], "key": 1548180000000 }, { "value": [0], "key": 1548183600000 }, { "value": [0], "key": 1548187200000 }, { "value": [0], "key": 1548190800000 }, { "value": [0], "key": 1548194400000 }, { "value": [0], "key": 1548198000000 }, { "value": [0], "key": 1548201600000 }, { "value": [0], "key": 1548205200000 }, { "value": [0], "key": 1548208800000 }, { "value": [22], "key": 1548212400000 }, { "value": [0], "key": 1548216000000 }, { "value": [0], "key": 1548219600000 }, { "value": [0], "key": 1548223200000 }, { "value": [0], "key": 1548226800000 }, { "value": [0], "key": 1548230400000 }, { "value": [0], "key": 1548234000000 }, { "value": [0], "key": 1548237600000 }, { "value": [0], "key": 1548241200000 }, { "value": [0], "key": 1548244800000 }, { "value": [0], "key": 1548248400000 }, { "value": [0], "key": 1548252000000 }, { "value": [0], "key": 1548255600000 }, { "value": [0], "key": 1548259200000 }, { "value": [0], "key": 1548262800000 }, { "value": [0], "key": 1548266400000 }, { "value": [0], "key": 1548270000000 }, { "value": [0], "key": 1548273600000 }, { "value": [0], "key": 1548277200000 }, { "value": [0], "key": 1548280800000 }, { "value": [0], "key": 1548284400000 }, { "value": [0], "key": 1548288000000 }, { "value": [0], "key": 1548291600000 }, { "value": [0], "key": 1548295200000 }, { "value": [1], "key": 1548298800000 }, { "value": [0], "key": 1548302400000 }, { "value": [16], "key": 1548306000000 }, { "value": [14], "key": 1548309600000 }, { "value": [0], "key": 1548313200000 }, { "value": [0], "key": 1548316800000 }, { "value": [0], "key": 1548320400000 }, { "value": [0], "key": 1548324000000 }, { "value": [0], "key": 1548327600000 }, { "value": [0], "key": 1548331200000 }, { "value": [0], "key": 1548334800000 }, { "value": [0], "key": 1548338400000 }, { "value": [0], "key": 1548342000000 }, { "value": [0], "key": 1548345600000 }, { "value": [0], "key": 1548349200000 }, { "value": [0], "key": 1548352800000 }, { "value": [0], "key": 1548356400000 }, { "value": [0], "key": 1548360000000 }, { "value": [0], "key": 1548363600000 }, { "value": [0], "key": 1548367200000 }, { "value": [0], "key": 1548370800000 }, { "value": [0], "key": 1548374400000 }, { "value": [10], "key": 1548378000000 }, { "value": [38], "key": 1548381600000 }, { "value": [0], "key": 1548385200000 }, { "value": [0], "key": 1548388800000 }, { "value": [0], "key": 1548392400000 }, { "value": [0], "key": 1548396000000 }, { "value": [0], "key": 1548399600000 }, { "value": [0], "key": 1548403200000 }, { "value": [0], "key": 1548406800000 }, { "value": [0], "key": 1548410400000 }, { "value": [0], "key": 1548414000000 }, { "value": [0], "key": 1548417600000 }, { "value": [0], "key": 1548421200000 }, { "value": [0], "key": 1548424800000 }, { "value": [0], "key": 1548428400000 }, { "value": [0], "key": 1548432000000 }, { "value": [0], "key": 1548435600000 }, { "value": [0], "key": 1548439200000 }, { "value": [0], "key": 1548442800000 }, { "value": [0], "key": 1548446400000 }, { "value": [0], "key": 1548450000000 }, { "value": [0], "key": 1548453600000 }, { "value": [0], "key": 1548457200000 }, { "value": [0], "key": 1548460800000 }, { "value": [0], "key": 1548464400000 }, { "value": [0], "key": 1548468000000 }, { "value": [0], "key": 1548471600000 }, { "value": [0], "key": 1548475200000 }, { "value": [0], "key": 1548478800000 }, { "keyExtend": 1548484423000, "value": [0], "key": 1548482400000 }] }

function selectPivot(arr) {
  // 选择枢纽的函数 
  const idx = Math.floor(arr.length / 2);
  //  const pivot=arr[idx];
  const pivot = arr.splice(idx, 1)[0];
  return pivot;
}

function quickSort(arr) {
  if (arr.length <= 1) { return arr; }
  /* 枢纽选择：三者取中法 */
  const len = arr.length - 1;
  let pivot = selectPivot(arr)  //选择枢纽 idx
  let left = [],
    right = [];
  for (let i = 0; i < len; i++) {
    if (arr[i].date > pivot.date) {
      right.push(arr[i])
    } else {
      left.push(arr[i])
    }
  }
  return quickSort(left).concat([pivot], quickSort(right));
}




function parseTo2dArr(data) {
  let rs = [];
  data.aggs.forEach(el => {
    let hour = new Date(el['key']).getHours();

    if (!rs[hour]) {
      rs[hour] = []
    }
    rs[hour].push({ 'value': el.value, 'date': el["key"] });

  })
  // console.log(rs.length)

  for (let i = 0; i < rs.length; i++) {
    rs[i] = quickSort(rs[i])
  }

  // console.log(rs)
  return rs;
}

// parseTo2dArr(data);

module.exports = parseTo2dArr(data);




